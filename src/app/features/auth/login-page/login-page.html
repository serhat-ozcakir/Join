<div class="login-card">
  <h1 class="title">Log in</h1>
  <div class="underline"></div>

  @if (supabase.authError()) {
  <div class="error-message">{{ supabase.authError() }}</div>
  }

  <form novalidate #loginForm="ngForm" (ngSubmit)="loginForm.valid && login()">
    <div class="form-group">
  <div class="input-wrap">
    <input
      type="email"
      placeholder="Email"
      [ngModel]="email()"
      (ngModelChange)="email.set($event)"
      name="email"
      required
      #emailInput="ngModel"
    />
    <img class="input-icon" src="assets/icons/mail.png" alt="" aria-hidden="true" />
  </div>
      @if (emailInput.invalid && emailInput.touched) {
      <span class="error">Valid email is required</span>
      }
    </div>

    <div class="form-group">
  <div class="input-wrap">
    <input
      type="password"
      placeholder="Password"
      [ngModel]="password()"
      (ngModelChange)="password.set($event)"
      name="password"
      required
      minlength="6"
      #passwordInput="ngModel"
    />
    <img class="input-icon" src="assets/icons/lock.png" alt="" aria-hidden="true" />
  </div>

      @if (passwordInput.invalid && passwordInput.touched) {
      <span class="error">Password must be at least 6 characters</span>
      }
    </div>

    <div class="actions">
      <button class="btn btn-primary" type="submit" [disabled]="loginForm.invalid || supabase.authLoading()">
        {{ supabase.authLoading() ? 'Loading...' : 'Log in' }}
      </button>

      <button class="btn btn-secondary" type="button" (click)="guestLogin()">
        Guest Log in
      </button>
    </div>
  </form>
</div>